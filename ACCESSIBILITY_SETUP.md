# 📱 無障礙服務設定完整教學

## 為什麼需要無障礙服務？

無障礙服務讓 Kids Time Control 可以：
- ✅ 監控孩童是否嘗試切換到其他 APP
- ✅ 當孩童離開 APP 時自動跳回
- ✅ 實現真正的裝置鎖定功能

> ⚠️ **重要**：這是 APP 正常運作的必要步驟！

---

## 🎯 設定流程（詳細步驟）

### 方法 1：從 APP 內啟動（推薦）

#### 步驟 1：啟用開發者模式
1. 開啟 Kids Time Control APP
2. 在主畫面，點擊**標題「你好！」2 次**（快速連點）
3. 接著點擊下方**「數位健康提醒」卡片 2 次**（快速連點）
4. 底部會出現「測試控制」區塊
   - 顯示「鎖定裝置」和「解鎖裝置」按鈕

#### 步驟 2：觸發無障礙服務設定
1. 點擊「**鎖定裝置**」按鈕
2. 會彈出對話框：「**需要啟用無障礙服務**」
3. 內容顯示：
   ```
   為了鎖定裝置功能正常運作，需要啟用無障礙服務。

   請在設定中找到「Kids Time Control」並啟用。
   ```
4. 點擊「**前往設定**」按鈕
5. 系統會自動跳轉到無障礙設定頁面

#### 步驟 3：在設定中啟用服務
現在你應該在「無障礙」設定頁面：

1. **找到服務**
   - 頁面標題顯示「無障礙」
   - 往下捲動到「已下載的應用程式」或「已安裝的服務」區塊
   - 找到「**Kids Time Control**」（可能顯示為 `LockAccessibilityService`）

2. **點擊進入**
   - 點擊「Kids Time Control」項目
   - 會進入服務詳細設定頁面

3. **啟用服務**
   - 頁面上方有一個**開關（Switch）**
   - 預設是**關閉**（灰色）
   - **點擊開關**，變成**開啟**（藍色/綠色）

4. **確認授權**
   - 會彈出警告對話框：
     ```
     允許 Kids Time Control 完全控制您的裝置嗎？

     此應用程式將能夠：
     • 檢視畫面上的內容
     • 控制畫面內容
     • 執行操作
     ```
   - 這是系統的標準警告，**點擊「確定」或「允許」**

5. **完成設定**
   - 開關保持開啟狀態
   - 頁面顯示服務已啟用
   - 按返回鍵回到 APP

#### 步驟 4：驗證設定成功
1. 回到 Kids Time Control APP
2. 再次點擊「**鎖定裝置**」
3. 如果設定成功：
   - 畫面會變成黑色鎖定畫面
   - 顯示大型鎖頭圖示
   - 無法切換到其他 APP
4. 如果還是彈出「需要啟用無障礙服務」：
   - 表示設定失敗，請重新執行步驟 3

---

### 方法 2：手動從系統設定進入

如果方法 1 的「前往設定」按鈕沒反應，可以手動進入：

#### 步驟 1：打開系統設定
1. 打開手機的「**設定**」APP
2. 往下捲動找到「**無障礙**」或「**協助工具**」
   - Samsung：設定 → 無障礙
   - 小米/紅米：設定 → 更多設定 → 無障礙
   - OPPO/realme：設定 → 其他設定 → 無障礙
   - 華為：設定 → 輔助功能 → 無障礙

#### 步驟 2：找到 Kids Time Control
1. 進入「無障礙」頁面
2. 往下捲動到「**已下載的應用程式**」區塊
3. 找到「**Kids Time Control**」

#### 步驟 3-5：同方法 1

---

## 🔍 常見問題排解

### Q1: 找不到「Kids Time Control」服務
**可能原因：**
- APP 沒有正確安裝
- 系統需要重新掃描服務

**解決方法：**
1. 完全關閉 Kids Time Control APP
2. 從最近使用的應用中清除
3. 重新開啟 APP
4. 如果還是找不到，重新安裝 APP：
   ```bash
   adb uninstall com.kidstimecontrol.app
   adb install app-debug.apk
   ```

### Q2: 開關啟用後又自動關閉
**可能原因：**
- 系統安全設定阻擋
- 電池優化限制

**解決方法：**
1. 關閉電池優化：
   - 設定 → 電池 → 電池優化
   - 找到 Kids Time Control
   - 選擇「不優化」

2. 允許背景運行：
   - 設定 → 應用程式 → Kids Time Control
   - 電池 → 背景限制 → 選擇「不限制」

### Q3: 點擊「前往設定」沒反應
**解決方法：**
- 使用方法 2 手動進入系統設定
- 或重啟 APP 後再試一次

### Q4: 啟用後鎖定還是可以切換 APP
**可能原因：**
- 服務啟用了但沒有正確運作
- 需要重啟服務

**解決方法：**
1. 在無障礙設定中，關閉服務開關
2. 等待 3 秒
3. 重新開啟服務開關
4. 回到 APP 測試

### Q5: 系統警告「此應用可能不安全」
**說明：**
- 這是 Android 對所有無障礙服務的標準警告
- Kids Time Control 是開源專案，不會竊取資料
- 只用於監控 APP 切換，實現時間控制功能

**解決方法：**
- 點擊「確定」或「我了解」繼續
- 如果擔心安全，可以檢視開源程式碼

---

## 📋 不同品牌手機的路徑

### Samsung (三星)
```
設定 → 無障礙 → 已安裝的服務 → Kids Time Control
```

### Xiaomi / Redmi (小米/紅米)
```
設定 → 更多設定 → 無障礙 → 已安裝的服務 → Kids Time Control
```

### OPPO / Realme
```
設定 → 其他設定 → 無障礙 → 已下載的服務 → Kids Time Control
```

### Huawei (華為)
```
設定 → 輔助功能 → 無障礙 → 無障礙應用 → Kids Time Control
```

### Vivo
```
設定 → 更多設定 → 無障礙 → 已安裝的服務 → Kids Time Control
```

### Google Pixel / 原生 Android
```
Settings → Accessibility → Downloaded apps → Kids Time Control
```

---

## 🎬 設定完成後的測試

### 測試鎖定功能
1. **啟用開發者模式**（如果還沒啟用）
   - 標題點 2 次 + 卡片點 2 次

2. **鎖定裝置**
   - 點擊「鎖定裝置」按鈕
   - 畫面應該變黑

3. **測試防切換**
   - 按 Home 鍵 → 應該自動跳回 APP
   - 按最近任務鍵 → 應該自動跳回 APP
   - 嘗試打開其他 APP → 應該自動跳回 APP

4. **測試解鎖**
   - 在鎖定畫面，點擊鎖頭圖示 5 次
   - 輸入 PIN 碼（預設 1234）
   - 選擇增加時間或設定 PIN
   - 成功解鎖

---

## 🔒 安全性說明

### 無障礙服務的權限
Kids Time Control 的無障礙服務**只做一件事**：
```java
// 監控應用切換
if (切換到其他 APP && 裝置已鎖定) {
    跳回 Kids Time Control
}
```

### 我們**不會**做的事
- ❌ 讀取其他 APP 的內容
- ❌ 竊取密碼或個人資料
- ❌ 截圖或錄影
- ❌ 監控訊息內容
- ❌ 追蹤位置

### 開源透明
- 所有程式碼都在 GitHub 上公開
- 可以隨時檢視 `LockAccessibilityService.java`
- 歡迎安全專家檢視

---

## ⚠️ 重要提醒

1. **必須保持啟用**
   - 無障礙服務關閉後，鎖定功能會失效
   - 建議設定後不要關閉

2. **電池優化**
   - 將 APP 設為「不優化」
   - 避免系統自動關閉服務

3. **系統更新後**
   - Android 系統更新可能重設無障礙服務
   - 更新後請重新檢查設定

4. **多用戶/訪客模式**
   - 某些手機的訪客模式不支援無障礙服務
   - 建議在主用戶下使用

---

## 📞 需要協助？

如果按照以上步驟仍無法設定成功，請提供：
1. 手機品牌和型號
2. Android 版本
3. 無法成功的具體步驟
4. 錯誤訊息截圖

---

## ✅ 設定檢查清單

完成設定後，確認以下項目：

- [ ] 無障礙設定中「Kids Time Control」開關是開啟的
- [ ] 點擊「鎖定裝置」後畫面變黑
- [ ] 鎖定後按 Home 鍵會自動跳回 APP
- [ ] 點擊鎖頭 5 次可以進入家長驗證
- [ ] 可以成功增加時間並解鎖

全部勾選 ✅ 表示設定成功！

---

**設定成功後，Kids Time Control 就能正常運作，有效管理孩童的螢幕使用時間！** 💚
